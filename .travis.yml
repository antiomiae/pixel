language: c++
dist: trusty
sudo: required

env:
  matrix:
    - TRAVIS_NO_EMPTY_JOB=true

matrix:
  exclude:
    - env: TRAVIS_NO_EMPTY_JOB=true

  include:
    - env: CC=clang-5.0 CXX=clang++-5.0 JOBS=1

before_install:
  - wget https://cmake.org/files/v3.9/cmake-3.9.6-Linux-x86_64.tar.gz
  - tar xf cmake-3.9.6-Linux-x86_64.tar.gz
  - sudo cp cmake-3.9.6-Linux-x86_64/bin/* /usr/local/bin
  - sudo cp -r cmake-3.9.6-Linux-x86_64/share/cmake-3.9/ /usr/local/share/
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
  - wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key|sudo apt-key add -
  - sudo add-apt-repository -y "deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-5.0 main"
  - sudo add-apt-repository -y "deb http://ppa.launchpad.net/ubuntu-toolchain-r/test/ubuntu trusty main"
  - sudo apt -o Acquire::AllowInsecureRepositories=true update
  - sudo apt-get -qq update
  - sudo apt-get -y install clang-5.0 ninja-build mesa-common-dev libgl1-mesa-dev #make

before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3

script:
  - CC=clang-5.0 CXX=clang++-5.0 ./init && ./build && ./test

notifications:
email: false
